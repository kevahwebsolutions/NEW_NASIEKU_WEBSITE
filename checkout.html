<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Nasieku Luxury Creations - checkout</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="assets/img/favicon.ico">
    
    <!-- CSS 
    ========================= -->


    <!-- Plugins CSS -->
    <link rel="stylesheet" href="assets/css/plugins.css">
    
    <!-- Main Style CSS -->
    <link rel="stylesheet" href="assets/css/style.css">

    <!--modernizr min js here-->
    <script src="assets/js/vendor/modernizr-3.7.1.min.js"></script>

</head>

<body>

   <!-- Main Wrapper Start -->
    <!--Offcanvas menu area start-->
    <div class="off_canvars_overlay">

    </div>
    <div class="Offcanvas_menu">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="canvas_open">
                        <a href="javascript:void(0)"><i class="ion-navicon"></i></a>
                    </div>
                    <div class="Offcanvas_menu_wrapper">
                        <div class="canvas_close">
                            <a href="javascript:void(0)"><i class="ion-android-close"></i></a>
                        </div>
                        <div id="menu" class="text-left ">
                            <ul class="offcanvas_main_menu">
                                <li class="menu-item-has-children active">
                                    <a href="index.html">Home</a> </li>
                                <li> <a href="shop.html">Shop</a></li>
                                <li><a href="about.html">About Us</a></li>
                                <li><a href="contact.html">Contact Us</a></li>
                                        
                        </div>
                        <div class="Offcanvas_footer">
                            <span><a href="mailto:info@naeku-luxury.co.ke"><i class="fa fa-envelope-o"></i> info@naeku-luxury.co.ke</a></span>
                            <ul class="social_icons">
                                    <li>
                                        <a href="https://www.facebook.com/people/Nasieku-Luxury-Creations/100066309080077/"
                                            target="_blank" rel="noopener noreferrer">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="#1877F2">
                                                <path
                                                    d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z" />
                                            </svg>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://www.tiktok.com/@naeku_luxcreations" target="_blank"
                                            rel="noopener noreferrer">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="#000000">
                                                <path
                                                    d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-.99-.32-2.15-.23-3.02.37-.63.41-1.11 1.04-1.36 1.75-.21.51-.15 1.07-.14 1.61.24 1.64 1.82 3.02 3.5 2.87 1.12-.01 2.19-.66 2.77-1.61.19-.33.4-.67.41-1.06.1-1.79.06-3.57.07-5.36.01-4.03-.01-8.05.02-12.07z" />
                                            </svg>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://www.instagram.com/nasiekucreations/" target="_blank"
                                            rel="noopener noreferrer">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="#E4405F">
                                                <path
                                                    d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z" />
                                            </svg>
                                        </a>
                                    </li>
                                </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Offcanvas menu area end-->

    <!--header area start-->
    <header class="header_area">

        <!--header middel start-->
<div class="header_middel header_middle9">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-2 col-md-3 col-4">
                <div class="logo">
                    <a href="index.html"><img src="assets/img/logo/logo.png" alt=""></a>
                </div>
            </div>
            <div class="col-lg-10 col-md-7 col-6">
                <div class="middel_right">
                    <!-- Desktop Search (visible on md and up) -->
                    <div class="search_container_new search-form d-none d-md-block">
                        <form action="#" class="search-form">
                            <div class="search_box">
                                <input placeholder="Search products..." type="text" autocomplete="off">
                                <button type="submit" class="search-button">
                                    <i class="ion-ios-search-strong"></i>
                                    <span class="search-text">Search</span>
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <div class="middel_rightinfo_new">
                        <!-- Mobile Search Button (visible only on mobile, positioned before settings) -->
                        <div class="search_btn d-md-none">
                            <a href="#" class="mobile-search-toggle"><i class="ion-ios-search-strong"></i></a>
                            <div class="dropdown_search search-form">
                                <form action="#" class="search-form">
                                    <div class="search_box">
                                        <input placeholder="Search products..." type="text" autocomplete="off"> 
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="cart_link">
                            <a href="#"><i class="ion-android-cart"></i><span class="cart_text_quantity">0</span> <i class="fa fa-angle-down"></i></a>
                            <span class="cart_quantity">0</span>
                            <!--mini cart-->
                            <div class="mini_cart">
                                <div class="cart_close">
                                    <div class="cart_text">
                                        <h3>cart</h3>
                                    </div>
                                    <div class="mini_cart_close">
                                        <a href="javascript:void(0)"><i class="ion-android-close"></i></a>
                                    </div>
                                </div>
                                <div class="cart_items_container">
                                    <!-- Cart items will be inserted here dynamically -->
                                </div>
                                <div class="cart_total">
                                    <span>Subtotal:</span>
                                    <span class="cart_subtotal">Ksh 0</span>
                                </div>
                                <div class="mini_cart_footer">
                                    <div class="cart_button view_cart">
                                        <a href="cart.html">View cart</a>
                                    </div>
                                    <div class="cart_button checkout">
                                        <a class="active" href="checkout.html">Checkout</a>
                                    </div>
                                </div>
                            </div>
                            <!--mini cart end-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--header middel end-->

        <!--header bottom satrt-->
        <div class="header_bottom header_bottom9  sticky-header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-3 col-md-12">
    <div class="categories_menu">
        <div class="categories_title">
            <h2 class="categori_toggle">VIEW CATEGORIES</h2>
        </div>
        <div class="categories_menu_toggle">
            <ul>
    <li><a href="shop.html?category=all&label=All Products">All Products</a></li>
    <li><a href="shop.html?category=clothing and fashion&label=Clothes%20%26%20Fashion">Clothes & Fashion</a></li>
    <li><a href="shop.html?category=bags&label=Bags">Bags</a></li>
    <li><a href="shop.html?category=home decor&label=Home%20Decor%20%26%20Entertainment">Home Decor & Entertainment</a></li>
    <li><a href="shop.html?category=jewelry&label=Jewelry%20%26%20Accessories">Jewelry & Accessories</a></li>
    <li><a href="shop.html?category=art&label=African%20Art%20%26%20Collectibles">African Art & Collectibles</a></li>
</ul>
        </div>
    </div>
</div>
                    <div class="col-lg-9 col-md-12">
                        <div class="main_menu_inner main_menu9_inner">
                            <div class="logo_sticky">
                                <a href="index.html"><img src="assets/img/logo/logo.png" alt=""></a>
                            </div>
                            <div class="main_menu">
                                <nav>
                                    <ul>

                                        <li ><a href="index.html">Home</a></li>
                                        <li><a href="shop.html">shop </a></li>
                                        <!-- <li><a href="blog.html">blog <i class="fa fa-angle-down"></i></a>
                                            <ul class="sub_menu pages">
                                                <li><a href="blog-details.html">blog details</a></li>
                                                <li><a href="blog-fullwidth.html">blog fullwidth</a></li>
                                                <li><a href="blog-left.html">blog left</a></li>
                                                <li><a href="blog-none-sidebar.html">no sidebar</a></li>
                                                <li><a href="blog-right.html">blog right</a></li>
                                                <li><a href="blog-sticky.html">blog sticky</a></li>
                                            </ul>
                                        </li> -->
                                        <li><a href="about.html">About Us</a></li>
                                        <li><a href="contact.html">contact</a></li>
                                        <!-- <li><a href="#">pages <i class="fa fa-angle-down"></i></a>
                                            <ul class="sub_menu pages">
                                                
                                                <li><a href="services.html">services</a></li>
                                                <li><a href="faq.html">Frequently Questions</a></li>
                                                
                                                <li><a href="login.html">login</a></li>
                                                <li><a href="wishlist.html">Wishlist</a></li>
                                                <li><a href="404.html">Error 404</a></li>
                                                <li><a href="compare.html">compare</a></li>
                                                <li><a href="privacy-policy.html">privacy policy</a></li>
                                                <li><a href="coming-soon.html">coming soon</a></li>
                                            </ul>
                                        </li> -->
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--header bottom end-->
    </header>
    <!--header area end-->

    <!--breadcrumbs area start-->
    <div class="breadcrumbs_area">
        <div class="container">   
            <div class="row">
                <div class="col-12">
                    <div class="breadcrumb_content">
                        <h3>Checkout</h3>
                        <ul>
                            <li><a href="index.html">home</a></li>
                            <li>></li>
                            <li>Checkout</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>         
    </div>
    <!--breadcrumbs area end-->
    
    
    
    <!-- Checkout Page Section -->
<div class="Checkout_section" id="accordion">
  <div class="container">
    <div class="checkout_form">
      <form action="https://api.web3forms.com/submit" method="POST" id="order-form">
        <input type="hidden" name="access_key" value="0e1eddcf-3892-41a6-aa8a-8f5ecf573890" />
        <input type="hidden" name="subject" value="🛍️ New Order #{{ORDER_NUMBER}} from Nasieku Website" />
        <input type="hidden" name="from_name" value="Nasieku Orders" />
        <input type="text" name="honeypot" style="display:none">
        
        <div class="row">
          <!-- Shipping Details -->
          <div class="col-lg-6 col-md-6">
            <h3>Shipping Details</h3>
            <div class="row">
              <div class="col-lg-6 mb-20">
                <label>First Name <span>*</span></label>
                <input type="text" name="first_name" required>
              </div>
              <div class="col-lg-6 mb-20">
                <label>Last Name <span>*</span></label>
                <input type="text" name="last_name" required>
              </div>
              <div class="col-12 mb-20">
                <label>County <span>*</span></label>
                <input type="text" name="county" required>
              </div>
              <div class="col-12 mb-20">
                <label>Street Address <span>*</span></label>
                <input type="text" name="street_address" placeholder="House number and street name" required>
              </div>
              <div class="col-12 mb-20">
                <input type="text" name="apartment" placeholder="Apartment, suite, unit etc. (optional)">
              </div>
              <div class="col-12 mb-20">
                <label>Town / City <span>*</span></label>
                <input type="text" name="city" required>
              </div>
              <div class="col-lg-6 mb-20">
                <label>Phone <span>*</span></label>
                <input type="text" name="phone" required>
              </div>
              <div class="col-lg-6 mb-20">
                <label>Email Address <span>*</span></label>
                <input type="email" name="email" required>
              </div>
              <div class="col-12 mb-20">
                <label for="order_note">Order Notes</label>
                <textarea name="order_notes" id="order_note" placeholder="Notes about your order..."></textarea>
              </div>
            </div>
          </div>

          <!-- Replace the Order Summary section in your checkout.html (around line 179-215) -->

<!-- Order Summary -->
<div class="col-lg-6 col-md-6">
    <h3>Order Summary</h3>
    <div class="order_table table-responsive">
        <table class="order-summary-table">
            <thead>
                <tr>
                    <th>Product</th>
                    <th>Price</th>
                    <th>Qty</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody id="order-summary-items">
                <!-- Products will be inserted here by JavaScript -->
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="3">Subtotal</td>
                    <td id="order-subtotal">Ksh 0</td>
                </tr>
                <tr>
                    <td colspan="3">Shipping</td>
                    <td>Ksh 400</td>
                </tr>
                <tr class="total-row">
                    <td colspan="3"><strong>Total</strong></td>
                    <td><strong id="order-total">Ksh 400</strong></td>
                </tr>
            </tfoot>
        </table>
    </div>
    <div class="order_button mt-3">
        <button type="submit" id="submit-btn">Place Order</button>
    </div>
    <div id="order-status"></div>
</div>

<!-- Fixed Checkout Script -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Get cart from localStorage (this is your existing data source)
    const cartData = localStorage.getItem('nasieku_cart');
    const cart = JSON.parse(cartData) || [];
    
    const orderItemsContainer = document.getElementById('order-summary-items');
    const orderSubtotal = document.getElementById('order-subtotal');
    const orderTotal = document.getElementById('order-total');
    const form = document.getElementById('order-form');
    
    // Check if elements exist
    if (!orderItemsContainer || !orderSubtotal || !orderTotal || !form) {
        console.error('Required elements not found');
        return;
    }
    
    const orderNumber = 'NSK-' + Math.floor(100000 + Math.random() * 900000);
    let calculatedTotal = 0;

    function displayOrderSummary() {
        let subtotal = 0;
        let productsHTML = '';
        let emailProducts = '';
        
        if (cart.length === 0) {
            productsHTML = '<tr><td colspan="4" style="text-align:center; padding: 20px;">Your cart is empty. <a href="shop.html">Continue shopping</a></td></tr>';
        } else {
            cart.forEach((item) => {
                const itemPrice = parseFloat(item.price);
                const itemQty = parseInt(item.quantity);
                const itemTotal = itemPrice * itemQty;
                subtotal += itemTotal;
                
                productsHTML += `
                    <tr class="cart-item-row">
                        <td class="product-info-cell">
                            <div class="product-info">
                                <img src="${item.img}" alt="${item.name}" class="product-thumbnail">
                                <span class="product-name">${item.name}</span>
                            </div>
                        </td>
                        <td class="price-cell">Ksh ${itemPrice.toLocaleString()}</td>
                        <td class="qty-cell">${itemQty}</td>
                        <td class="total-cell">Ksh ${itemTotal.toLocaleString()}</td>
                    </tr>
                `;
                
                emailProducts += `${item.name} (Qty: ${itemQty}) - Ksh ${itemTotal.toLocaleString()}\n`;
            });
        }
        
        orderItemsContainer.innerHTML = productsHTML;
        const shipping = 400;
        calculatedTotal = subtotal + shipping;
        
        orderSubtotal.textContent = `Ksh ${subtotal.toLocaleString()}`;
        orderTotal.textContent = `Ksh ${calculatedTotal.toLocaleString()}`;
        
        return { subtotal, emailProducts };
    }

    const orderData = displayOrderSummary();

    // Payment Modal HTML
    const paymentModalHTML = `
        <div id="payment-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 9999; align-items: center; justify-content: center;">
            <div style="background: white; padding: 30px; border-radius: 10px; max-width: 400px; width: 90%; text-align: center;">
                <h3 style="margin-bottom: 20px; color: #333;">Complete Payment</h3>
                <p style="margin-bottom: 20px; color: #666;">Enter your M-Pesa number to receive payment prompt</p>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; text-align: left; font-weight: 600;">M-Pesa Phone Number</label>
                    <input type="tel" id="mpesa-phone" placeholder="0712345678 or 254712345678" 
                           style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 5px; font-size: 16px;">
                    <small style="display: block; margin-top: 5px; color: #999; text-align: left;">Format: 0712345678 or 254712345678</small>
                </div>

                <div style="margin-bottom: 20px; padding: 15px; background: #f8f8f8; border-radius: 5px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span>Amount to Pay:</span>
                        <strong>Ksh ${calculatedTotal.toLocaleString()}</strong>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>Order #:</span>
                        <strong>${orderNumber}</strong>
                    </div>
                </div>

                <div id="payment-status" style="margin-bottom: 15px;"></div>

                <div style="display: flex; gap: 10px;">
                    <button type="button" id="cancel-payment-btn" style="flex: 1; padding: 12px; background: #ccc; border: none; border-radius: 5px; cursor: pointer; font-size: 16px;">Cancel</button>
                    <button type="button" id="confirm-payment-btn" style="flex: 1; padding: 12px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; font-weight: 600;">Pay Now</button>
                </div>
            </div>
        </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', paymentModalHTML);

    const modal = document.getElementById('payment-modal');
    const mpesaPhoneInput = document.getElementById('mpesa-phone');
    const confirmPaymentBtn = document.getElementById('confirm-payment-btn');
    const cancelPaymentBtn = document.getElementById('cancel-payment-btn');
    const paymentStatus = document.getElementById('payment-status');

    // Form submission - Show payment modal
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        if (cart.length === 0) {
            alert('Your cart is empty! Please add items before checkout.');
            window.location.href = 'shop.html';
            return;
        }

        if (!form.checkValidity()) {
            form.reportValidity();
            return;
        }

        modal.style.display = 'flex';
        mpesaPhoneInput.focus();
    });

    // Cancel payment
    cancelPaymentBtn.addEventListener('click', function() {
        modal.style.display = 'none';
        mpesaPhoneInput.value = '';
        paymentStatus.innerHTML = '';
        confirmPaymentBtn.disabled = false;
        confirmPaymentBtn.textContent = 'Pay Now';
        cancelPaymentBtn.disabled = false;
    });

    // Process payment
    confirmPaymentBtn.addEventListener('click', async function() {
        const phoneNumber = mpesaPhoneInput.value.trim();
        
        if (!phoneNumber) {
            alert('Please enter your M-Pesa phone number');
            return;
        }

        const phoneRegex = /^(0|254|\+254)?[17]\d{8}$/;
        if (!phoneRegex.test(phoneNumber.replace(/\s+/g, ''))) {
            alert('Invalid phone number format. Use: 0712345678 or 254712345678');
            return;
        }

        confirmPaymentBtn.disabled = true;
        confirmPaymentBtn.textContent = 'Processing...';
        cancelPaymentBtn.disabled = true;

        paymentStatus.innerHTML = `
            <div style="padding: 15px; background: #e3f2fd; border-radius: 5px; color: #1976d2;">
                <div style="margin-bottom: 10px;">📱 Check your phone for M-Pesa prompt</div>
                <div class="spinner" style="margin: 10px auto; border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite;"></div>
                <small>Waiting for payment confirmation...</small>
            </div>
        `;

        try {
            const formData = new FormData(form);
            const orderDetails = {
                first_name: formData.get('first_name'),
                last_name: formData.get('last_name'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                county: formData.get('county'),
                city: formData.get('city'),
                street_address: formData.get('street_address'),
                apartment: formData.get('apartment'),
                order_notes: formData.get('order_notes'),
                order_number: orderNumber,
                order_details: `
ORDER #${orderNumber}
--------------------------
${orderData.emailProducts}
--------------------------
Subtotal: Ksh ${orderData.subtotal.toLocaleString()}
Shipping: Ksh 400
Total: Ksh ${calculatedTotal.toLocaleString()}
                `
            };

            console.log('Sending payment request...');
            
            const response = await fetch('https://nasieku-payment-backend.vercel.app/api/process-payment', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    phone_number: phoneNumber,
                    amount: calculatedTotal,
                    order_number: orderNumber,
                    customer_name: `${orderDetails.first_name} ${orderDetails.last_name}`,
                    customer_email: orderDetails.email,
                    order_details: orderDetails
                })
            });

            console.log('Response status:', response.status);
            
            const result = await response.json();
            console.log('Response data:', result);

            if (result.success) {
                paymentStatus.innerHTML = `
                    <div style="padding: 20px; background: #d4edda; border-radius: 5px; color: #155724;">
                        <svg viewBox="0 0 24 24" width="48" height="48" style="margin-bottom: 10px;">
                            <path fill="currentColor" d="M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12l1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                        <h4>✅ Payment Successful!</h4>
                        <p>Order #${orderNumber} confirmed</p>
                        <small>Ref: ${result.transaction_ref || 'N/A'}</small>
                    </div>
                `;

                // Clear cart after successful payment
                localStorage.removeItem('nasieku_cart');

                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 3000);

            } else {
                throw new Error(result.error || 'Payment failed');
            }

        } catch (error) {
            console.error('Payment error:', error);
            
            paymentStatus.innerHTML = `
                <div style="padding: 20px; background: #f8d7da; border-radius: 5px; color: #721c24;">
                    <h4>❌ Payment Failed</h4>
                    <p>${error.message}</p>
                    <small>Please try again or contact support</small>
                </div>
            `;

            confirmPaymentBtn.disabled = false;
            confirmPaymentBtn.textContent = 'Try Again';
            cancelPaymentBtn.disabled = false;
        }
    });
});
</script>

<style>
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
</style>

<!-- Updated Styles - FIXED SCROLL ISSUE -->
<style>
/* Order Summary Table - NO SCROLL FIX */
.order_table {
    width: 100%;
    max-width: 100%;
}

.order-summary-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
    table-layout: fixed; /* This prevents overflow */
}

/* Column widths to prevent overflow */
.order-summary-table th:nth-child(1),
.order-summary-table td:nth-child(1) {
    width: 45%; /* Product column */
}

.order-summary-table th:nth-child(2),
.order-summary-table td:nth-child(2) {
    width: 20%; /* Price column */
}

.order-summary-table th:nth-child(3),
.order-summary-table td:nth-child(3) {
    width: 15%; /* Qty column */
}

.order-summary-table th:nth-child(4),
.order-summary-table td:nth-child(4) {
    width: 20%; /* Total column */
}

.order-summary-table th, 
.order-summary-table td {
    padding: 12px 8px;
    text-align: left;
    border-bottom: 1px solid #eee;
    vertical-align: middle;
    word-wrap: break-word;
}

.order-summary-table th {
    font-weight: 600;
    background-color: #f9f9f9;
    font-size: 13px;
    text-transform: uppercase;
}

/* Product Info Cell with Image */
.product-info-cell {
    overflow: hidden;
}

.product-info {
    display: flex;
    align-items: center;
    gap: 10px;
}

.product-thumbnail {
    width: 50px;
    height: 50px;
    object-fit: cover;
    border-radius: 4px;
    border: 1px solid #eee;
    flex-shrink: 0;
}

.product-name {
    font-size: 13px;
    line-height: 1.3;
    color: #333;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
}

/* Other cells */
.price-cell, .qty-cell, .total-cell {
    white-space: nowrap;
    font-size: 13px;
}

.qty-cell {
    text-align: center;
    font-weight: 600;
}

.total-cell {
    font-weight: 600;
    color: #333;
}

.total-row td {
    border-top: 2px solid #333;
    font-size: 1.05em;
    padding-top: 12px;
}

/* Laptop/Desktop specific fixes */
@media (min-width: 992px) and (max-width: 1400px) {
    .order-summary-table {
        font-size: 12px;
    }
    
    .product-thumbnail {
        width: 45px;
        height: 45px;
    }
    
    .product-name {
        font-size: 12px;
    }
    
    .order-summary-table th, 
    .order-summary-table td {
        padding: 10px 6px;
    }
}

/* Tablet */
@media (max-width: 991px) {
    .order-summary-table th:nth-child(1),
    .order-summary-table td:nth-child(1) {
        width: 40%;
    }
    
    .product-thumbnail {
        width: 45px;
        height: 45px;
    }
    
    .product-name {
        font-size: 12px;
    }
}

/* Mobile */
@media (max-width: 576px) {
    .order_table {
        overflow-x: visible;
    }
    
    .order-summary-table {
        font-size: 12px;
        table-layout: auto;
    }
    
    .order-summary-table thead {
        display: none;
    }
    
    .cart-item-row {
        display: block;
        margin-bottom: 15px;
        border: 1px solid #eee;
        padding: 10px;
        border-radius: 4px;
    }
    
    .order-summary-table td {
        display: block;
        width: 100% !important;
        text-align: left !important;
        border: none;
        padding: 5px 0;
    }
    
    .product-info-cell {
        overflow: visible;
    }
    
    .product-name {
        -webkit-line-clamp: unset;
        overflow: visible;
    }
    
    .price-cell::before {
        content: "Price: ";
        font-weight: 600;
    }
    
    .qty-cell::before {
        content: "Quantity: ";
        font-weight: 600;
    }
    
    .qty-cell {
        text-align: left !important;
    }
    
    .total-cell::before {
        content: "Total: ";
        font-weight: 600;
    }
    
    .order-summary-table tfoot tr {
        display: table-row;
    }
    
    .order-summary-table tfoot td {
        display: table-cell;
        width: auto !important;
    }
}

/* Order Status Styles */
.order-status-loading, 
.order-status-success, 
.order-status-error {
    text-align: center;
    padding: 20px;
    margin-top: 20px;
    border-radius: 4px;
}

.order-status-loading {
    background-color: #f8f8f8;
}

.order-status-success {
    background-color: #f0fff0;
    color: #2e7d32;
}

.order-status-success a {
    color: #2e7d32;
    text-decoration: underline;
}

.order-status-error {
    background-color: #fff0f0;
    color: #c62828;
}

.spinner {
    border: 4px solid #f3f3f3;
    border-top: 4px solid #3498db;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    animation: spin 1s linear infinite;
    margin: 0 auto 15px;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Order Button */
.order_button button {
    width: 100%;
    padding: 15px;
    background-color: #333;
    color: white;
    border: none;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.3s;
}

.order_button button:hover {
    background-color: #555;
}

.order_button button:disabled {
    background-color: #999;
    cursor: not-allowed;
}
</style>
 
    <!--footer area start-->
    <footer class="footer_widgets">
        <div class="container">
            <div class="footer_top">
                <div class="row">
                    <div class="col-lg-4 col-md-6 col-sm-8">
                        <div class="widgets_container contact_us">
                            <h3>About Nasieku</h3>
                            <div class="footer_contact">
                                <p>Empowering Maasai women through traditional craftsmanship</p>
                                <p>Phone: <a href="tel:+254721500197">+254 721 500 197</a></p>
                                <p>Email: <a href="mailto:info@naeku-luxury.co.ke">info@naeku-luxury.co.ke</a></p>
                                <ul class="social_icons">
                                    <li>
                                        <a href="https://www.facebook.com/people/Nasieku-Luxury-Creations/100066309080077/"
                                            target="_blank" rel="noopener noreferrer">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="#1877F2">
                                                <path
                                                    d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z" />
                                            </svg>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://www.tiktok.com/@naeku_luxcreations" target="_blank"
                                            rel="noopener noreferrer">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="#000000">
                                                <path
                                                    d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-.99-.32-2.15-.23-3.02.37-.63.41-1.11 1.04-1.36 1.75-.21.51-.15 1.07-.14 1.61.24 1.64 1.82 3.02 3.5 2.87 1.12-.01 2.19-.66 2.77-1.61.19-.33.4-.67.41-1.06.1-1.79.06-3.57.07-5.36.01-4.03-.01-8.05.02-12.07z" />
                                            </svg>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://www.instagram.com/nasiekucreations/" target="_blank"
                                            rel="noopener noreferrer">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="#E4405F">
                                                <path
                                                    d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z" />
                                            </svg>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-6 col-sm-4 col-6">
                        <div class="widgets_container widget_menu">
                            <h3>Information</h3>
                            <div class="footer_menu">
                                <ul>
                                    <li><a href="about.html">Our Story</a></li>
                                    <li><a href="impact.html">Social Impact</a></li>
                                    <li><a href="contact.html">Contact Us</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-6 col-sm-5 col-6">
                        <div class="widgets_container widget_menu">
                            <h3>Customer Care</h3>
                            <div class="footer_menu">
                                <ul>
                                    <li><a href="shipping.html">Shipping Policy</a></li>
                                    <li><a href="returns.html">Returns & Exchanges</a></li>
                                    <li><a href="privacy.html">Privacy Policy</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
    <div class="widgets_container newsletter">
        <h3>Join Our Community</h3>
        <p>Subscribe for updates on new Maasai collections and our women's empowerment initiatives</p>
        <div class="subscribe_form">
            <form id="sidebar-newsletter-form" method="POST" action="https://api.web3forms.com/submit" novalidate></form>
                <input type="hidden" name="access_key" value="0e1eddcf-3892-41a6-aa8a-8f5ecf573890">
                <input type="hidden" name="subject" value="Community Newsletter Subscription">
                <!-- Remove redirect since you want to stay on page -->
                <input type="text" name="Community Subscription" style="display:none"> <!-- Add honeypot -->
                
                <input name="email" placeholder="Your email address..." type="email" required>
                <button type="submit">Subscribe</button>
                
                <div class="web3forms-feedback" style="margin-top: 10px; font-size: 14px;">
                    <div class="web3forms-submitting" style="display: none; color: #666;">Submitting...</div>
                    <div class="web3forms-success" style="display: none; color: #28a745;">Thank you for subscribing!</div>
                    <div class="web3forms-error" style="display: none; color: #dc3545;">Error: Please try again later.</div>
                </div>
            </form>
        </div>
    </div>
</div>                </div>
            </div>
            <div class="footer_bottom">
                <div class="row">
                    <div class="col-12">
                        <div class="copyright_area">
                            <p>© 2025 <strong>Nasieku Luxury Creations</strong>. All Rights Reserved | Luxury Is In The
                                Details</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!--footer area end-->

<!-- JS
============================================ -->

<!-- Plugins JS -->
<script src="assets/js/vendor/jquery-3.4.1.min.js"></script>
<script src="assets/js/popper.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/plugins.js"></script>
<script src="assets/js/owl.carousel.main.js"></script>
<script src="assets/js/jquery.nice.select.js"></script>
<script src="assets/js/scrollup.js"></script>
<script src="assets/js/ajax.chimp.js"></script>
<script src="assets/js/jquery.ui.js"></script>
<script src="assets/js/jquery.elevatezoom.js"></script>
<script src="assets/js/imagesloaded.js"></script>
<script src="assets/js/isotope.main.js"></script>
<script src="assets/js/jqquery.ripples.js"></script>
<script src="assets/js/jquery.cookie.js"></script>
<script src="assets/js/bpopup.js"></script>
<script src="assets/js/header-categories.js"></script>
<script src="assets/js/cart.js"></script>
<script src="assets/js/cart-page.js"></script>
    <script src="assets/js/search.js"></script>
    <script src="assets/js/globalsearch.js"></script>

<!-- Main JS -->
<script src="assets/js/main.js"></script>



</body>
</html>